<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa de Londres - Puntos de Inter√©s</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="./assets/style.css">
    <link rel="icon" type="image/avif" href="assets/winter.avif">
</head>
<body>
  <div class="header">
    <div style="display:flex;align-items:center;">
      <h1><i class="fas fa-map-marked-alt"></i> London Visit</h1>
      <p style="margin-left:8px;">Visita del 19/12/2025 al 22/12/2025 ‚Äî Maider & Luc√≠a</p>
    </div>
    <div style="display:flex;align-items:center;gap:10px;">
      <button class="menu-btn" id="btnMenu" aria-label="abrir menu">
        <i class="fas fa-bars"></i>
      </button>
    </div>
  </div>

  <div class="sidebar" id="sidebar">
    <h2><i class="fas fa-star"></i> Puntos de Inter√©s</h2>

    <!-- NOTA: data-type = 'poi' y data-index corresponde al √≠ndice 0-based en pointsOfInterest -->
    <div class="poi-item" onclick="focusOnMarker(10)">
      <div>
        <h3><i class="fas fa-bed"></i> Stay at Safestay London Elephant & Castle</h3>
        <p>Alojamiento econ√≥mico y moderno en el coraz√≥n de Londres.</p>
      </div>
      <label class="toggle-xmas">
        <input type="checkbox" class="check" data-type="poi" data-index="10">
        <span class="slider"></span>
      </label>
    </div>

    <div class="poi-item" onclick="focusOnMarker(0)">
      <div>
        <h3><i class="fas fa-crown"></i> Palacio de Buckingham</h3>
        <p>Residencia oficial de la monarqu√≠a brit√°nica.</p>
      </div>
      <label class="toggle-xmas">
        <input type="checkbox" class="check" data-type="poi" data-index="0">
        <span class="slider"></span>
      </label>
    </div>

    <div class="poi-item" onclick="focusOnMarker(1)">
      <div>
        <h3><i class="fas fa-clock"></i> Big Ben y el Parlamento</h3>
        <p>El ic√≥nico reloj de Londres y sede del gobierno brit√°nico.</p>
      </div>
      <label class="toggle-xmas">
        <input type="checkbox" class="check" data-type="poi" data-index="1">
        <span class="slider"></span>
      </label>
    </div>

    <div class="poi-item" onclick="focusOnMarker(2)">
      <div>
        <h3><i class="fas fa-place-of-worship"></i> Torre de Londres</h3>
        <p>Fortaleza hist√≥rica y hogar de las joyas de la corona.</p>
      </div>
      <label class="toggle-xmas">
        <input type="checkbox" class="check" data-type="poi" data-index="2">
        <span class="slider"></span>
      </label>
    </div>

    <div class="poi-item" onclick="focusOnMarker(3)">
      <div>
        <h3><i class="fas fa-bridge"></i> Tower Bridge</h3>
        <p>Puente levadizo con vistas al T√°mesis.</p>
      </div>
      <label class="toggle-xmas">
        <input type="checkbox" class="check" data-type="poi" data-index="3">
        <span class="slider"></span>
      </label>
    </div>

    <div class="poi-item" onclick="focusOnMarker(4)">
      <div>
        <h3><i class="fas fa-museum"></i> Museo Brit√°nico</h3>
        <p>Tesoros de la historia mundial.</p>
      </div>
      <label class="toggle-xmas">
        <input type="checkbox" class="check" data-type="poi" data-index="4">
        <span class="slider"></span>
      </label>
    </div>

    <div class="poi-item" onclick="focusOnMarker(11)">
      <div>
        <h3><i class="fas fa-tree"></i> Natural History Museum</h3>
        <p>Famoso por su colecci√≥n de dinosaurios.</p>
      </div>
      <label class="toggle-xmas">
        <input type="checkbox" class="check" data-type="poi" data-index="11">
        <span class="slider"></span>
      </label>
    </div>

    <div class="poi-item" onclick="focusOnMarker(5)">
      <div>
        <h3><i class="fas fa-shopping-bag"></i> Harrods</h3>
        <p>El centro comercial m√°s lujoso de Londres.</p>
      </div>
      <label class="toggle-xmas">
        <input type="checkbox" class="check" data-type="poi" data-index="5">
        <span class="slider"></span>
      </label>
    </div>

    <div class="poi-item" onclick="focusOnMarker(6)">
      <div>
        <h3><i class="fas fa-theater-masks"></i> Shakespeare's Globe</h3>
        <p>Teatro reconstruido al estilo isabelino.</p>
      </div>
      <label class="toggle-xmas">
        <input type="checkbox" class="check" data-type="poi" data-index="6">
        <span class="slider"></span>
      </label>
    </div>

    <div class="poi-item" onclick="focusOnMarker(7)">
      <div>
        <h3><i class="fas fa-eye"></i> London Eye</h3>
        <p>Noria gigante con vistas panor√°micas.</p>
      </div>
      <label class="toggle-xmas">
        <input type="checkbox" class="check" data-type="poi" data-index="7">
        <span class="slider"></span>
      </label>
    </div>

    <div class="poi-item" onclick="focusOnMarker(8)">
      <div>
        <h3><i class="fas fa-cathedral"></i> Catedral de San Pablo</h3>
        <p>C√∫pula ic√≥nica de Sir Christopher Wren.</p>
      </div>
      <label class="toggle-xmas">
        <input type="checkbox" class="check" data-type="poi" data-index="8">
        <span class="slider"></span>
      </label>
    </div>

    <div class="poi-item" onclick="focusOnMarker(9)">
      <div>
        <h3><i class="fas fa-water"></i> Camden Lock</h3>
        <p>Mercado alternativo junto al canal.</p>
      </div>
      <label class="toggle-xmas">
        <input type="checkbox" class="check" data-type="poi" data-index="9">
        <span class="slider"></span>
      </label>
    </div>

    <!-- COMIDA: data-type = 'food', √≠ndices 0-based para eatingPlaces -->
    <h2 style="margin-top:8px;"><i class="fas fa-utensils"></i> Comer</h2>

    <div class="food-item" onclick="focusOnFoodMarker(0)">
      <div>
        <h3><i class="fas fa-store"></i> Camden Market</h3>
        <p>Puestos variados con mucha comida internacional.</p>
      </div>
      <label class="toggle-xmas">
        <input type="checkbox" class="check" data-type="food" data-index="0">
        <span class="slider"></span>
      </label>
    </div>

    <div class="food-item" onclick="focusOnFoodMarker(1)">
      <div>
        <h3><i class="fas fa-hamburger"></i> Kung Fu Burger</h3>
        <p>Hamburguesas con opciones vegetarianas.</p>
      </div>
      <label class="toggle-xmas">
        <input type="checkbox" class="check" data-type="food" data-index="1">
        <span class="slider"></span>
      </label>
    </div>

    <div class="food-item" onclick="focusOnFoodMarker(2)">
      <div>
        <h3><i class="fas fa-drumstick-bite"></i> JI chicken shop</h3>
        <p>Pollo frito estilo coreano, con alternativas.</p>
      </div>
      <label class="toggle-xmas">
        <input type="checkbox" class="check" data-type="food" data-index="2">
        <span class="slider"></span>
      </label>
    </div>
  </div>

  <div class="map-container">
    <div id="map"></div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // Inicializar mapa
    const map = L.map('map').setView([51.5074, -0.1278], 12);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '¬© OpenStreetMap contributors'
    }).addTo(map);

    // ICONOS
    const markerNormalIcon = L.divIcon({
      html: '<div style="background: #667eea; color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-size: 14px; box-shadow: 0 2px 10px rgba(102, 126, 234, 0.5);"><i class="fas fa-map-marker-alt"></i></div>',
      className: 'custom-marker',
      iconSize: [30,30]
    });

    const foodIcon = L.divIcon({
      html: '<div style="background: #ea6666; color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-size: 14px; box-shadow: 0 2px 10px rgba(244, 162, 97, 0.5);"><i class="fas fa-utensils"></i></div>',
      className: 'custom-marker',
      iconSize: [30,30]
    });

    // Datos
    const pointsOfInterest = [
      { name: "Palacio de Buckingham", coords: [51.5014, -0.1419], description: "La residencia oficial ...", info: "üé´ Entrada: ¬£30 | üöá Victoria" },
      { name: "Big Ben y el Parlamento", coords: [51.5007, -0.1246], description: "El reloj m√°s famoso ...", info: "üì∏ Desde Westminster | üöá Westminster" },
      { name: "Torre de Londres", coords: [51.5081, -0.0759], description: "Fortaleza hist√≥rica ...", info: "üé´ ¬£29.90 | üöá Tower Hill" },
      { name: "Tower Bridge", coords: [51.5055, -0.0754], description: "Puente levadizo ...", info: "üé´ Exhibition: ¬£12.30 | üöá Tower Hill" },
      { name: "Museo Brit√°nico", coords: [51.5194, -0.1270], description: "Museo con millones de objetos ...", info: "üé´ Gratis | ‚è∞ 10:00-17:00" },
      { name: "Harrods", coords: [51.4994, -0.1634], description: "Centro comercial de lujo ...", info: "üõçÔ∏è 10:00-21:00 | üöá Knightsbridge" },
      { name: "Shakespeare's Globe", coords: [51.5081, -0.0972], description: "Teatro reconstruido ...", info: "üé´ Tours: ¬£17 | üöá London Bridge" },
      { name: "London Eye", coords: [51.5033, -0.1196], description: "Noria gigante ...", info: "üé´ ¬£31 | ‚è∞ 30 min | üöá Waterloo" },
      { name: "Catedral de San Pablo", coords: [51.5138, -0.0983], description: "Catedral de Sir Christopher Wren ...", info: "üé´ ¬£20 | üöá St. Paul's" },
      { name: "Camden Lock", coords: [51.5390, -0.1426], description: "Mercado junto al canal ...", info: "üé´ Gratis | üöá Camden Town" },
      { name: "Stay at Safestay London Elephant & Castle", coords: [51.4945, -0.1003], description: "Alojamiento econ√≥mico ...", info: "üí∞ Desde ¬£25 | üöá Elephant & Castle" },
      { name: "Natural History Museum", coords: [51.4967, -0.1764], description: "Museo de historia natural ...", info: "üé´ Gratis | ‚è∞ 10:00-17:30 | üöá South Kensington" }
    ];

    const eatingPlaces = [
      { name: "Camden Market", coords: [51.5416, -0.1420], description: "Mercado vibrante ...", info: "üç¥ Opciones veganas | ‚è∞ 10:00-18:00" },
      { name: "Kung Fu Burger", coords: [51.5120, -0.0905], description: "Hamburguesas ...", info: "Precios: ¬£5-¬£10 | üöá Tower Hill" },
      { name: "JI chicken shop", coords: [51.5155, -0.0722], description: "Pollo frito coreano ...", info: "Precios: ¬£7-¬£12 | üöá London Bridge" }
    ];

    // Arrays para almacenar marcadores
    const markers = [];
    const foodMarkers = [];

    // A√±adir POIs
    pointsOfInterest.forEach((poi, idx) => {
      const mk = L.marker(poi.coords, { icon: markerNormalIcon }).addTo(map);
      mk.bindPopup(`<div class="popup-title">${poi.name}</div><div class="popup-description">${poi.description}</div><div class="popup-info">${poi.info}</div>`, { maxWidth: 300, className: 'custom-popup' });
      markers.push(mk);
    });

    // A√±adir sitios de comida
    eatingPlaces.forEach((place, idx) => {
      const mk = L.marker(place.coords, { icon: foodIcon }).addTo(map);
      mk.bindPopup(`<div class="popup-title">${place.name}</div><div class="popup-description">${place.description}</div><div class="popup-info">${place.info}</div>`, { maxWidth: 300, className: 'custom-popup' });
      foodMarkers.push(mk);
    });

    // Zoom effect (ajusta iconos si quieres)
    map.on('zoomend', () => {
      const z = map.getZoom();
      // aqu√≠ podr√≠as variar iconSize o clases si lo deseas
    });

    // Focus helpers
    function focusOnMarker(index) {
      const target = markers[index];
      if (!target) return;
      const latLng = target.getLatLng();
      map.setView(latLng, 16);
      target.openPopup();
      if (window.innerWidth <= 768) document.getElementById('map').scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    function focusOnFoodMarker(index) {
      const target = foodMarkers[index];
      if (!target) return;
      const latLng = target.getLatLng();
      map.setView(latLng, 16);
      target.openPopup();
      if (window.innerWidth <= 768) document.getElementById('map').scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    // Checkboxes: toggling de marcadores
    document.querySelectorAll('.check').forEach(chk => {
      // aseguramos que el checked inicial refleja el estado en el mapa (todos a√±adidos arriba)
      chk.addEventListener('change', (e) => {
        const marker = getMarkerFromCheckbox(chk);
        if (!marker) return;
        if (chk.checked) {
          map.removeLayer(marker);
        } else {
          map.addLayer(marker);
        }
      });
    });

    function getMarkerFromCheckbox(chk) {
      const type = chk.dataset.type;
      const idx = Number(chk.dataset.index);
      if (type === 'poi') {
        return markers[idx];
      } else if (type === 'food') {
        return foodMarkers[idx];
      }
      return null;
    }

    // Control de geolocalizaci√≥n (control de Leaflet)
    if (navigator.geolocation) {
      const locationControl = L.control({ position: 'topright' });
      locationControl.onAdd = function() {
        const div = L.DomUtil.create('div', 'leaflet-bar leaflet-control leaflet-control-custom');
        div.style.background = '#fff'; div.style.padding = '6px'; div.style.borderRadius = '4px';
        div.style.boxShadow = '0 1px 5px rgba(0,0,0,0.15)';
        div.innerHTML = '<button title="Mi ubicaci√≥n" style="background:none;border:none;cursor:pointer;"><i class="fas fa-location-arrow" style="color:#667eea;"></i></button>';
        L.DomEvent.disableClickPropagation(div);
        div.addEventListener('click', () => {
          navigator.geolocation.getCurrentPosition(pos => {
            const userLat = pos.coords.latitude;
            const userLng = pos.coords.longitude;
            // Comprobar aproximaci√≥n a Londres
            if (userLat > 51.2 && userLat < 51.7 && userLng > -0.5 && userLng < 0.3) {
              map.setView([userLat, userLng], 15);
              const um = L.circleMarker([userLat, userLng], { radius:6, fillColor:'#2b9df4', fillOpacity:1, stroke:false }).addTo(map);
              um.bindPopup('üìç Tu ubicaci√≥n actual').openPopup();
              setTimeout(() => { if (map.hasLayer(um)) map.removeLayer(um); }, 6000);
            } else {
              // Mensaje r√°pido
              const tempMsg = L.control({ position:'topright' });
              tempMsg.onAdd = () => {
                const d = L.DomUtil.create('div','leaflet-control leaflet-bar');
                d.innerHTML = '<div style="background:#fff;padding:8px;border-radius:4px;">No est√°s en Londres</div>';
                setTimeout(() => tempMsg.remove(), 2200);
                return d;
              };
              tempMsg.addTo(map);
              map.setView([51.5074, -0.1278], 12);
            }
          }, err => {
            alert('No se pudo acceder a la geolocalizaci√≥n: ' + (err.message || err));
          });
        });
        return div;
      };
      locationControl.addTo(map);
    }

    // Menu toggle
    const btnMenu = document.getElementById('btnMenu');
    const sidePanel = document.getElementById('sidebar');
    btnMenu.addEventListener('click', (e) => {
      e.stopPropagation();
      sidePanel.classList.toggle('open');
    });
    // cerrar al tocar fuera
    document.addEventListener('click', e => {
      if (!sidePanel.contains(e.target) && e.target !== btnMenu) sidePanel.classList.remove('open');
    });

    console.log('üó∫Ô∏è Mapa de Londres cargado con √©xito!');
    console.log('üìç Total POIs:', pointsOfInterest.length, ' ‚Äî Comida:', eatingPlaces.length);
  </script>
</body>
</html>
